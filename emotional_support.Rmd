---
title: "Emotional and Social Support"
subtitle: 'The Impact of Emotional and Social Support on Health Outcomes'
author: "Minh Pham"
date: "5/04/2020"
output: pdf_document
geometry: "left=2.5cm,right=2.5cm,top=1cm,bottom=2cm"
longtable: true
header-includes:
- \usepackage{longtable,booktabs,multirow}
- \usepackage[justification=centering]{caption}
- \usepackage{float}
- \floatplacement{figure}{H}
fontsize: 12pt
linestretch: 1.2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,tidy.opts=list(width.cutoff=55),tidy=TRUE, warning = F,message = F)
```


```{r,include=FALSE, echo=FALSE}
library(devtools)
library(readr)
library(pscl)
library(spdep)
library(MASS)
library(readxl)
library(lodown)
library(tidyverse)
library(survey)
library(zoo)
library(dplyr)
library(srvyr)
library(ggplot2)
library(sjstats)
library(quantmod)
library(multiwayvcov)
library(InformationValue)
library(lmtest)
library(mpath)
library(rsq)
library(stargazer)
library(gtsummary)
library(gt)
library(glue)
library(effects)
library(reshape2)
library(ROSE)
library(randomForest)
library(countreg)
library(mfx)
library(censReg)
```


```{r, include=FALSE, echo=FALSE}
brfss_df13 <- 
    readRDS( file.path( path.expand( "~" ) , "BRFSS" , "2013 main.rds" ) )
brfss_df14 <- 
    readRDS( file.path( path.expand( "~" ) , "BRFSS" , "2014 main.rds" ) )
brfss_df15 <- 
    readRDS( file.path( path.expand( "~" ) , "BRFSS" , "2015 main.rds" ) )
brfss_df16 <- 
    readRDS( file.path( path.expand( "~" ) , "BRFSS" , "2016 main.rds" ) )
brfss_df17 <- 
    readRDS( file.path( path.expand( "~" ) , "BRFSS" , "2017 main.rds" ) )

brfss_df13$xpsu=as.integer(brfss_df13$xpsu)
brfss_df14$xpsu=as.integer(brfss_df14$xpsu)
brfss_df15$xpsu=as.integer(brfss_df15$xpsu)
brfss_df16$xpsu=as.integer(brfss_df16$xpsu)
brfss_df17$xpsu=as.integer(brfss_df17$xpsu)


### Create date
brfss_df13$iyear <- rep(2013,nrow(brfss_df13)) # make new column
brfss_df13$Date <- as.Date( paste(brfss_df13$iyear, brfss_df13$imonth , brfss_df13$iday , sep = "." )  , format = "%Y.%m.%d" )
brfss_df13=brfss_df13[order(as.Date(brfss_df13$Date, format="%d/%m/%Y")),]

brfss_df14$iyear <- rep(2014,nrow(brfss_df14)) # make new column
brfss_df14$Date <- as.Date( paste(brfss_df14$iyear, brfss_df14$imonth , brfss_df14$iday , sep = "." )  , format = "%Y.%m.%d" )
brfss_df14=brfss_df14[order(as.Date(brfss_df14$Date, format="%d/%m/%Y")),]

brfss_df15$iyear <- rep(2015,nrow(brfss_df15)) # make new column
brfss_df15$Date <- as.Date( paste(brfss_df15$iyear, brfss_df15$imonth , brfss_df15$iday , sep = "." )  , format = "%Y.%m.%d" )
brfss_df15=brfss_df15[order(as.Date(brfss_df15$Date, format="%d/%m/%Y")),]

brfss_df16$iyear <- rep(2016,nrow(brfss_df16)) # make new column
brfss_df16$Date <- as.Date( paste(brfss_df16$iyear, brfss_df16$imonth , brfss_df16$iday , sep = "." )  , format = "%Y.%m.%d" )
brfss_df16=brfss_df16[order(as.Date(brfss_df16$Date, format="%d/%m/%Y")),]

brfss_df17$iyear <- rep(2017,nrow(brfss_df17)) # make new column
brfss_df17$Date <- as.Date( paste(brfss_df17$iyear, brfss_df17$imonth , brfss_df17$iday , sep = "." )  , format = "%Y.%m.%d" )
brfss_df17=brfss_df17[order(as.Date(brfss_df17$Date, format="%d/%m/%Y")),]


brfss_df1314 <- intersect(colnames(brfss_df13), colnames(brfss_df14))

brfss_df1314 <- rbind(brfss_df13[ , brfss_df1314], brfss_df14[ , brfss_df1314])

brfss_df131415 <- intersect(colnames(brfss_df1314), colnames(brfss_df15))

brfss_df131415 <- rbind(brfss_df1314[ , brfss_df131415], brfss_df15[ , brfss_df131415])

brfss_df13141516 <- intersect(colnames(brfss_df131415), colnames(brfss_df16))

brfss_df13141516 <- rbind(brfss_df131415[ , brfss_df13141516], brfss_df16[ , brfss_df13141516])

brfss_df1314151617 <- intersect(colnames(brfss_df13141516), colnames(brfss_df17))

brfss_df1314151617 <- rbind(brfss_df13141516[ , brfss_df1314151617], brfss_df17[ , brfss_df1314151617])


#write_csv(brfss_df131415161718, '/Users/minhpham1609/Desktop/brfss_df131415161718.csv')

# Var-names: xstate	fmonth	imonth	iday	iyear	dispcode	xpsu	pvtresd1	colghous	ladult	numadult	nummen	numwomen	genhlth	physhlth	menthlth	poorhlth	hlthpln1	persdoc2	medcost	checkup1	cvdinfr4	cvdcrhd4	cvdstrk3	asthma3	asthnow	chcscncr	chcocncr	chccopd1	havarth3	addepev2	diabete3	veteran3	marital	children	educa	employ1	income2	weight2	height3	renthom1	sex	pregnant	blind	decide	diffwalk	diffdres	diffalon	smoke100	smokday2	stopsmk2	lastsmk2	usenow3	alcday5	avedrnk2	drnk3ge5	maxdrnks	exerany2	seatbelt	flushot6	flshtmy2	hivtst6	hivtstd3	pdiabtst	prediab1	diabage2	insulin	bldsugar	doctdiab	chkhemo3	feetchk	diabeye	diabedu	imfvplac	hpvadvc2	hpvadsht	rcsgendr	rcsrltn2	casthdx2	casthno2	ctelnum1	cadult	cclghous	landline	qstver	qstlang	mscode	xststr	xstrwt	xrawrake	xwt2rake	xchispnc	xcrace1	xcllcpwt	xdualuse	xdualcor	xllcpwt	xrfhlth	xhcvu651	xltasth1	xcasthm1	xasthms1	xdrdxar1	xprace1	xmrace1	xhispanc	xrace	xraceg21	xracegr3	xracexg1	xageg5yr	xage65yr	xagexg	htin4	htm4	wtkg3	xbmi5	xbmi5cat	xrfbmi5	xchldcnt	xeducag	xincomg	xsmoker3	xrfsmok3	drnkany5	drocdy3x	xrfbing5	xtotinda	xrfseat2	xrfseat3	xflshot6	xaidtst3	xage80	one	Date

#first letâ€™s select a couple variables

brfss_df1314151617$state_name=factor(brfss_df1314151617$xstate , levels = 
                    c(1, 2, 4, 5, 6, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 
                    21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 
                    37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 53, 54, 
                    55, 56) ,
                    
                labels = 
                    c("ALABAMA", "ALASKA", "ARIZONA", "ARKANSAS", "CALIFORNIA", 
                    "COLORADO", "CONNECTICUT", "DELAWARE", "DISTRICT OF COLUMBIA", 
                    "FLORIDA", "GEORGIA", "HAWAII", "IDAHO", "ILLINOIS", "INDIANA",
                    "IOWA", "KANSAS", "KENTUCKY", "LOUISIANA", "MAINE", "MARYLAND",
                    "MASSACHUSETTS", "MICHIGAN", "MINNESOTA", "MISSISSIPPI", 
                    "MISSOURI", "MONTANA", "NEBRASKA", "NEVADA", "NEW HAMPSHIRE",
                    "NEW JERSEY", "NEW MEXICO", "NEW YORK", "NORTH CAROLINA", 
                    "NORTH DAKOTA", "OHIO", "OKLAHOMA", "OREGON", "PENNSYLVANIA",
                    "RHODE ISLAND", "SOUTH CAROLINA", "SOUTH DAKOTA", "TENNESSEE",
                    "TEXAS", "UTAH", "VERMONT", "VIRGINIA", "WASHINGTON",
                    "WEST VIRGINIA", "WISCONSIN", "WYOMING"))

# brfss_df131415161718s= brfss_df131415161718 %>% select(xstate,	fmonth,	imonth,	iday,	iyear,	dispcode,	xpsu,	physhlth,	menthlth,	poorhlth,decide,	marital,	employ1,	sex,	mscode,	xststr,	xstrwt,	xllcpwt,	xprace1,	xagexg,	xchldcnt,	xeducag,	xincomg,	Date,	state_name,drocdy3x,alcday5 ) ADDEPEV2


brfss.select= brfss_df1314151617 %>% select(xstate,	fmonth,	imonth,	iday,	iyear,	dispcode,	xpsu,	physhlth,	menthlth,	marital,	employ1,	sex,	xststr,	xstrwt,	xllcpwt,	xprace1,	xagexg,	xchldcnt,	xeducag,	xincomg,	Date,	state_name,genhlth,alcday5,drocdy3x,xbmi5,xrfbmi5,xrfsmok3, hlthpln1, cvdcrhd4,  xdrdxar1,xtotinda, diabete3, cvdstrk3, asthma3, chccopd1, addepev2, emtsuprt  ) 

```


```{r, include=FALSE, echo=FALSE}
#DATA cleaning:
brfss = brfss.select[which(brfss.select$addepev2 ==1),]

#recode main outcome categorical variables

# brfss_df131415161718s$difficult_making_decision = ifelse(brfss_df131415161718s$decide==1,1,ifelse(brfss_df131415161718s$decide==2,0,NA))

brfss$general_health_uncoded = ifelse( brfss$genhlth %in% 1:5 , as.numeric( brfss$genhlth <= 3 ) , NA )

brfss$emotional_support = ifelse( brfss$emtsuprt %in% 1:5 , as.numeric( brfss$emtsuprt < 3 ) , NA )

# brfss$life_satisfaction = ifelse( brfss$lsatisfy %in% 1:4 , as.numeric( brfss$lsatisfy <= 2 ) , NA )

brfss$diabete = ifelse( brfss$diabete3 ==1 , 1, ifelse(brfss$diabete3==3, 0, NA))

brfss$health_insured = ifelse( brfss$hlthpln1 ==1 , 1, ifelse(brfss$hlthpln1==2, 0, NA))

brfss$heart_disease = ifelse( brfss$cvdcrhd4 ==1 , 1, ifelse(brfss$cvdcrhd4==2, 0, NA))

brfss$arthritis = ifelse( brfss$xdrdxar1 ==1 , 1, ifelse(brfss$xdrdxar1==2, 0, NA))

brfss$exercise = ifelse( brfss$xtotinda ==1 , 1, ifelse(brfss$xtotinda==2, 0, NA))

brfss$stroke = ifelse( brfss$cvdstrk3 ==1 , 1, ifelse(brfss$cvdstrk3==2, 0, NA))

brfss$asthma = ifelse( brfss$asthma3 ==1 , 1, ifelse(brfss$asthma3==2, 0, NA))

brfss$bronchitis = ifelse( brfss$chccopd1 ==1 , 1, ifelse(brfss$chccopd1==2, 0, NA))

brfss$depression = ifelse( brfss$addepev2 ==1 , 1, ifelse(brfss$addepev2==2, 0, NA))


#recode main outcome continuous variable

brfss$mental_health = ifelse( brfss$menthlth %in% 1:30 , as.numeric( brfss$menthlth), ifelse(brfss$menthlth==88, brfss$menthlth==0, NA))

brfss$mental_health_recode = ifelse( brfss$menthlth %in% 1:30 , as.numeric( brfss$menthlth), ifelse(brfss$menthlth==88, brfss$menthlth==0, NA))

brfss$mental_health_recode = replace(brfss$mental_health_recode, brfss$mental_health_recode <10,1)
brfss$mental_health_recode= replace(brfss$mental_health_recode, brfss$mental_health_recode >=10,0)

# brfss$mentalandphysical_health = ifelse( brfss$poorhlth %in% 1:30 , as.numeric( brfss$poorhlth), ifelse(brfss$poorhlth==88, brfss$poorhlth==0, NA))

brfss$physical_health = ifelse( brfss$physhlth %in% 1:30 , as.numeric( brfss$physhlth), ifelse(brfss$physhlth==88, brfss$physhlth==0, NA))

brfss$physical_health_recode = ifelse( brfss$physhlth %in% 1:30 , as.numeric( brfss$physhlth), ifelse(brfss$physhlth==88, brfss$physhlth==0, NA))

brfss$physical_health_recode = replace(brfss$physical_health_recode, brfss$physical_health_recode <10,1)
brfss$physical_health_recode = replace(brfss$physical_health_recode, brfss$physical_health_recode >=10,0)

#recode main outcome variables
#Adults who reported having had at least one drink of alcohol in the past 30 days.
brfss$alcohol_consumption = ifelse( brfss$alcday5 %in% 201:230 , as.numeric( brfss$alcday5 - 200 ) ,ifelse(brfss$alcday5==888 , brfss$alcday5==0, NA ))
min(brfss$alcohol_consumption)
max(brfss$alcohol_consumption)

#Drink-occasions-per-day
# brfss$drink_occasions = ifelse( brfss$drocdy3x %in% 1:899 , as.numeric( brfss$drocdy3x), ifelse(brfss$drocdy3x==1, brfss$drocdy3x==0, NA))
# min(brfss$drink_occasions)
# max(brfss$drink_occasions)

brfss$calculated_bmi_index <- brfss$xbmi5/100

# brfss$diabetes_education= ifelse( brfss$diabedu ==1 , 1, ifelse(brfss$diabedu==2, 0, NA))
# 
# brfss$insulin= ifelse( brfss$insulin ==1 , 1, ifelse(brfss$insulin==2, 0, NA))

brfss$overweight = ifelse( brfss$xrfbmi5 ==1 , 1, ifelse(brfss$xrfbmi5==2, 0, NA))

brfss$calculated_current_smokers = ifelse(brfss$xrfsmok3==1,0,ifelse(brfss$xrfsmok3==2,1,NA))


#demographics
brfss$gender= ifelse( brfss$sex ==1 , 1, ifelse(brfss$sex==2, 0, NA))

brfss$number_of_children <-  ifelse( brfss$xchldcnt ==1 , 1, ifelse(brfss$xchldcnt==2, 2,ifelse(brfss$xchldcnt==3,3,ifelse(brfss$xchldcnt==4,4,ifelse(brfss$xchldcnt==5,5,ifelse(brfss$xchldcnt==6,6,ifelse(brfss$xchldcnt==9,9, NA)))))))

brfss$marital_status <-  ifelse( brfss$marital ==1 , 1, ifelse(brfss$marital==2, 2,ifelse(brfss$marital==3,3,ifelse(brfss$marital==4,4,ifelse(brfss$marital==5,5,ifelse(brfss$marital==6,6, ifelse(brfss$marital==9,9, NA)))))))

brfss$employment_status <- ifelse( brfss$employ1 ==1 , 1, ifelse(brfss$employ1==2, 2,ifelse(brfss$employ1==3,3,ifelse(brfss$employ1==4,4,ifelse(brfss$employ1==5,5,ifelse(brfss$employ1==6,6,ifelse(brfss$employ1==7,7,ifelse(brfss$employ1==8,8,ifelse(brfss$employ1==9,9, NA)))))))))

brfss$calculated_race <- ifelse( brfss$xprace1 ==1 , 1, ifelse(brfss$xprace1==2, 2,ifelse(brfss$xprace1==3,3,ifelse(brfss$xprace1==4,4,ifelse(brfss$xprace1==5,5,ifelse(brfss$xprace1==6,6,ifelse(brfss$xprace1==7,7, ifelse(brfss$xprace1==77,8, ifelse(brfss$xprace1==99,8, NA)))))))))

brfss$calculated_education <-ifelse( brfss$xeducag ==1 , 1, ifelse(brfss$xeducag==2, 2,ifelse(brfss$xeducag==3,3,ifelse(brfss$xeducag==4,4,ifelse(brfss$xeducag==9,9, NA)))))


brfss$calculated_income <- ifelse( brfss$xincomg ==1 , 1, ifelse(brfss$xincomg==2, 2,ifelse(brfss$xincomg==3,3,ifelse(brfss$xincomg==4,4,ifelse(brfss$xincomg==5,5,ifelse(brfss$xincomg==9,9, NA))))))

brfss$calculated_age <- ifelse( brfss$xagexg ==1 , 1, ifelse(brfss$xagexg==2, 2,ifelse(brfss$xagexg==3,3,ifelse(brfss$xagexg==4,4,ifelse(brfss$xagexg==5,5,ifelse(brfss$xagexg==6,6,NA))))))

# brfss$metropolitan_status <- ifelse( brfss$mscode ==1 , 1, ifelse(brfss$mscode==2, 2,ifelse(brfss$mscode==3,3,ifelse(brfss$mscode==5,5,NA))))

brfss=na.omit(brfss)
colSums(is.na(brfss))


```


```{r, include=FALSE, echo=FALSE}

brfss$gender=as.factor(recode(brfss$gender,'1'='male','0'='female',.missing='NA',.default = 'NA'))

brfss$number_of_children <- as.factor(recode(brfss$number_of_children, "1" = "nochildren", "2" = "1children", "3" = "2children", "4" = "3children", "5" = "4children", "6" = "5morechildren", "9"="others", .default =  "NA", .missing = "NA"))

brfss$marital_status <- as.factor(recode(brfss$marital_status, "1" = "married", "2" = "divorced","3"="widowed","4"="separated","5"="nevermarried","6"="membermarriedcoup","9"="refused",.default = "NA", .missing = "NA"))

brfss$employment_status <- as.factor(recode(brfss$employment_status, "1" = "wagesemployed", "2" = "selfemployed","3"="noworkmore1","4"="noworkless1","5"="homemaker","6"="student","7"="retired","8"="unable", "9"="refused",.default = "NA", .missing = "NA"))

brfss$calculated_race <- as.factor(recode(brfss$calculated_race, "1" = "white", "2" = "black","3"="native","4"="asian","5"="pacific","6"="other", "7"="nopreferred", "8"="others" ,.default = "NA", .missing = "NA"))

brfss$calculated_education <- as.factor(recode(brfss$calculated_education, "1" = "K", "2" = "HSgrad", "3" = "attendCOL", "4" = "COLgrad", "9"="others", .default = "NA", .missing = "NA")) 

brfss$calculated_income <- as.factor(recode(brfss$calculated_income, "1" = "le15K", "2" = "15to25K", "3" = "25to35K", "4" = "35to50K", "5" = "50more","9"="others", .default = "NA", missing = "NA"))

brfss$calculated_age <- as.factor(recode(brfss$calculated_age, "1" = "18to24", "2" = "25to34", "3" = "35to44", "4" = "45to54", "5" = "55to64", "6" = "65older", .default =  "NA", .missing = "NA"))

# brfss$metropolitan_status <- as.factor(recode(brfss$metropolitan_status, "1" = "citycenter", "2" = "countybutcenter", "3" = "suburban", "5" = "notMSA", .default =  "NA", .missing = "NA"))


#setting reference values
brfss$gender <- relevel(brfss$gender, ref = "female")
brfss$calculated_income <- relevel(brfss$calculated_income, ref = "50more")
brfss$calculated_education <- relevel(brfss$calculated_education, ref = "COLgrad")
brfss$calculated_age <- relevel(brfss$calculated_age, ref = "18to24")
brfss$marital_status = relevel(brfss$marital_status, ref = "married")
brfss$employment_status = relevel(brfss$employment_status, ref = "wagesemployed")
brfss$calculated_race = relevel(brfss$calculated_race, ref = "white")
brfss$number_of_children = relevel(brfss$number_of_children, ref = "nochildren")

#year and state dummies
brfss$iyear = as.factor(brfss$iyear)
brfss$imonth = as.factor(brfss$imonth)
brfss$state_name = as.factor(brfss$state_name)
brfss$state_name=tolower(brfss$state_name)

#state-specific-time trends
brfss$yearmonth=as.yearmon( paste(brfss$iyear, brfss$imonth, sep = "." )  , format = "%Y.%m" )
brfss$yearmonth = as.factor(brfss$yearmonth)

table(brfss$depression)

brfss= brfss %>% select(diabetes_education, calculated_age , gender , calculated_income , calculated_education , marital_status , number_of_children, employment_status , calculated_race , health_insured , heart_disease , arthritis , stroke , asthma , bronchitis , state_name , imonth , iyear, physical_health, mental_health, alcohol_consumption, calculated_bmi_index,overweight, calculated_current_smokers, exercise, xstrwt, calculated_bmi_index, emotional_support, diabete) 

brfss<- dummy_cols(brfss, select_columns = c("calculated_age", "gender","calculated_income","calculated_education","marital_status","number_of_children","employment_status","calculated_race"))

brfss.new <- brfss %>% select(-(2:9))

```



```{r, include=FALSE, echo=FALSE, eval = FALSE}
# # mental health models
model.glm.mental = glm(mental_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete +  state_name + imonth + iyear, family=poisson, weights = xstrwt,  data  = brfss)
sum.model.glm.mental=summary(model.glm.mental)
sum.model.glm.mental

model.glm.nb.mental = glm.nb(mental_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss)
sum.model.glm.nb.mental=summary(model.glm.nb.mental)
sum.model.glm.nb.mental #best model


model.glm.zf.mental = zeroinfl(mental_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear | emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "poisson")
sum.model.glm.zf.mental=summary(model.glm.zf.mental)
sum.model.glm.zf.mental

model.glm.zinb.mental = zeroinfl(mental_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear | emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "negbin")
sum.model.glm.zinb.mental=summary(model.glm.zinb.mental)
sum.model.glm.zinb.mental

countreg::rootogram(model.glm.nb.mental)
countreg::rootogram(model.glm.zinb.mental)

tobit.mental = censReg(mental_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis  + diabete + state_name + imonth + iyear,  data  = brfss)
sum.tobit.mental = summary(tobit.mental)
marginal.effect.mental = margEff(tobit.mental)

hurdle.mental = hurdle(mental_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "negbin", zero="negbin")
sum.hurdle.mental=summary(hurdle.mental)
sum.hurdle.mental

countreg::rootogram(hurdle.mental)
vuong(model.glm.zinb.mental, model.glm.nb.mental) 

# #physical health models
model.glm.physical = glm(physical_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, family=poisson, weights = xllcpwt,  data  = brfss)
sum.model.glm.physical=summary(model.glm.physical)
sum.model.glm.physical

model.glm.nb.physical = glm.nb(physical_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss)
sum.model.glm.nb.physical=summary(model.glm.nb.physical)
sum.model.glm.nb.physical

countreg::rootogram(model.glm.nb.physical)
countreg::rootogram(model.glm.zinb.physical)

model.glm.zf.physical = zeroinfl(physical_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear | emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "poisson")
sum.model.glm.zf.physical=summary(model.glm.zf.physical)
sum.model.glm.zf.physical

model.glm.zinb.physical = zeroinfl(physical_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear | emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "negbin")
sum.model.glm.zinb.physical=summary(model.glm.zinb.physical)
sum.model.glm.zinb.physical

tobit.physical = censReg(physical_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear,  data  = brfss)
sum.tobit.physical = summary(tobit.physical)
marginal.effect.physical = margEff(tobit.physical)

hurdle.physical = hurdle(physical_health ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "negbin")
sum.hurdle.physical=summary(hurdle.physical)
sum.hurdle.physical

countreg::rootogram(hurdle.physical)
vuong(model.glm.zinb.physical, model.glm.nb.physical) #this shows that zinb model is better


#alcohol_consumption model
model.glm.drinking = glm(alcohol_consumption ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, family=quasipoisson(link = "log"), weights = xstrwt,  data  = brfss)
sum.model.glm.drinking=summary(model.glm.drinking)
sum.model.glm.drinking

model.glm.nb.drinking = glm.nb(alcohol_consumption ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss)
sum.model.glm.nb.drinking=summary(model.glm.nb.drinking)
sum.model.glm.nb.drinking #best model

countreg::rootogram(model.glm.nb.drinking)

model.glm.zf.drinking = zeroinfl(alcohol_consumption ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear | emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "negbin")
sum.model.glm.zf.drinking=summary(model.glm.zf.drinking)
sum.model.glm.zf.drinking #best model

countreg::rootogram(model.glm.zf.drinking)

model.glm.zinb.drinking = zeroinfl(alcohol_consumption ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear | emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "negbin")
sum.model.glm.zinb.drinking=summary(model.glm.zinb.drinking)
sum.model.glm.zinb.drinking

countreg::rootogram(model.glm.zinb.drinking)

tobit.drinking = censReg(alcohol_consumption ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear,  data  = brfss)
sum.tobit.drinking = summary(tobit.drinking)
marginal.effect.drinking = margEff(tobit.drinking)

hurdle.drinking = hurdle(alcohol_consumption ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt,  data  = brfss, dist = "negbin")
sum.hurdle.drinking=summary(hurdle.drinking)
sum.hurdle.drinking

countreg::rootogram(hurdle.drinking)
```

```{r, include=FALSE, echo=FALSE, eval = FALSE}
# # #smoking
brfss.smoking = brfss %>% select(calculated_current_smokers, emotional_support , calculated_age , gender , calculated_income , calculated_education , marital_status , number_of_children, employment_status , calculated_race , health_insured , heart_disease , arthritis , state_name , imonth , iyear,xstrwt, stroke , asthma , bronchitis,diabete  )
brfss.smoking=na.omit(brfss.smoking)
table(brfss.smoking$calculated_current_smokers)
data_balanced_both.smoker <- ovun.sample(calculated_current_smokers ~  ., data = brfss.smoking, method = "both", p=0.5,  N=13410, seed = 1)$data
data_balanced_under.smoker <- ovun.sample(calculated_current_smokers ~  ., data = brfss.smoking, method = "under",  N=6742, seed = 1)$data

model.glm.smoker= glm(calculated_current_smokers ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt, family=quasibinomial(link=logit), data  = data_balanced_under.smoker)
sum.model.glm.smoker=summary(model.glm.smoker)
sum.model.glm.smoker

xb.logit.smoker <- predict(model.glm.smoker)
factor.logit.smoker <- mean(dlogis(xb.logit.smoker))
APE.logit.smoker <- coef(model.glm.smoker) * factor.logit.smoker

model.marginal.smoker = logitmfx(calculated_current_smokers ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, data  = data_balanced_both.smoker, atmean = FALSE)

# # #BMI model 
brfss.obesity = brfss %>% select(overweight, emotional_support , calculated_age , gender , calculated_income , calculated_education , marital_status , number_of_children, employment_status , calculated_race , health_insured , heart_disease , arthritis , state_name , imonth , iyear,xstrwt, stroke , asthma , bronchitis, diabete )
brfss.obesity=na.omit(brfss.obesity)
table(brfss.obesity$overweight)
data_balanced_both.obesity <- ovun.sample(overweight ~  ., data = brfss.obesity, method = "both", p=0.5,  N=13410, seed = 1)$data
data_balanced_under.obesity <- ovun.sample(overweight ~  ., data = brfss.obesity, method = "under",  N=7452, seed = 1)$data

model.glm.obesity = glm(overweight ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt, family=quasibinomial(link=logit), data  = data_balanced_under.obesity)
sum.model.glm.obesity=summary(model.glm.obesity)
sum.model.glm.obesity

xb.logit.obesity <- predict(model.glm.obesity)
factor.logit.obesity <- mean(dlogis(xb.logit.obesity))
APE.logit.obesity <- coef(model.glm.obesity) * factor.logit.obesity

model.marginal.obesity = logitmfx(overweight ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, data  = data_balanced_both.obesity, atmean = FALSE)

# exercise
brfss.exercise = brfss %>% select(exercise, emotional_support , calculated_age , gender , calculated_income , calculated_education , marital_status , number_of_children, employment_status , calculated_race , health_insured , heart_disease , arthritis , state_name , imonth , iyear,xstrwt,  stroke , asthma , bronchitis, diabete )
brfss.exercise=na.omit(brfss.exercise)
table(brfss.exercise$exercise)
data_balanced_both.exercise <- ovun.sample(exercise ~  ., data = brfss.exercise, method = "both", p=0.5,  N=13356, seed = 1)$data
data_balanced_under.exercise <- ovun.sample(exercise ~  ., data = brfss.exercise, method = "under",  N=8904, seed = 1)$data

model.glm.exercise = glm(exercise ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, weights = xstrwt, family=quasibinomial(link=logit), data  = data_balanced_under.exercise)
sum.model.glm.exercise=summary(model.glm.exercise)
sum.model.glm.exercise

xb.logit.exercise <- predict(model.glm.exercise)
factor.logit.exercise <- mean(dlogis(xb.logit.exercise))
APE.logit.exercise <- coef(model.glm.exercise) * factor.logit.exercise

model.marginal.exercise = logitmfx(exercise ~  emotional_support + calculated_age + gender + calculated_income + calculated_education + marital_status + number_of_children+ employment_status + calculated_race + health_insured + heart_disease + arthritis + stroke + asthma + bronchitis + diabete + state_name + imonth + iyear, data  = data_balanced_both.exercise, atmean = FALSE)

```

```{r , include=FALSE, echo=FALSE, eval = FALSE}
latex.count.outcome =stargazer(model.glm.zinb.physical,model.glm.zinb.mental,model.glm.zinb.drinking, type="latex",omit = c("imonth","iyear","state_name"),omit.labels =c("Month FE","Year FE","State FE"), omit.stat = c("rsq", "f"), column.labels = c("Physical Unhealthy Days","Mental Unhealthy Days", "Alcolhol Consumption"), title="Zero-inflated Regression Results for Count Outcomes")

latex.count.outcome.hurdle =stargazer(hurdle.physical,hurdle.mental, hurdle.drinking, type="latex",omit = c("imonth","iyear","state_name"),omit.labels =c("Month FE","Year FE","State FE"), omit.stat = c("rsq", "f"), column.labels = c("Physical Unhealthy Days","Mental Unhealthy Days", "Alcolhol Consumption"), title="Hurdle Regression Results for Count Outcomes")

latex.logistics=stargazer(model.glm.smoker,model.glm.obesity, model.glm.exercise,  type="latex",omit = c("imonth","iyear","state_name"),omit.labels =c("Month FE","Year FE","State FE"), omit.stat = c("rsq", "f"), column.labels = c("Current Smoker","Obesity", "Exercise"), title="Logistic Regression Results for Binary Outcomes")

```





\abstract{Recent research is expanding our understanding of the impact of social and emotional support on health. Many studies have focused on linking the relationship between physical health outcomes and social support but a few of them concentrated on the mechanisms that social and emotional support influence behavioral outcomes. In addition, the long-term impact of such influences remain to be determined, especially when it comes to the connection between social and emotional support and quality of life in many chronoc desease populations. This study uses the Behavioral Risk Factor Surveillance System (BRFSS) survey from 2013 to 2017 to investigates the long-term relationship between social and emotional support among respondents who currently suffer from chronic depression on different health outcomes and risky behaviors. Particularly, this study found that controlling for different chronic health conditions, there are significant evidence linking social and emotional support on mental health, physical health, physical activity, and other risky behaviors such as drinking, and smoking.}

# Introduction

Social and emotional support has been defined as resources and assistance exchanged through social relationships and interpersonal interactions, and serves four major functions: emotional (share problems, vent emotions), informational (advice and guidance), instrumental (provide a ride if car breaks down), and appraisal (comparing oneself to others). Much evidence has accrued that social and emotional support is associated with a reduced risk of mental and physical illness, as well as mortality, and has suggested that it confers benefits in cardiovascular, endocrine, and immune functioning. It can also affect the way, in which people cope with stress, the progression of illness, decision making for initiation and maintenance of behavioral change, and adherence to medical treatment and screening. More broadly, social and emotional support can increase personal competence, perceived control, sense of stability, and recognition of self-worth, and can have a positive effect on quality of life. Research also suggests that social and emotional support can influence health and longevity by bolstering self-esteem. It is important to note, however, that optimal social and emotional support varies highly between individuals, and that in order for support to be positive, it must be congruent with the desires of the person in need.

Given the positive associations with social and emotional support, as described above, it is evident that further examining and harnessing the influence of social and emotional support is critical for psychiatric and medical care. Indeed, policy makers have recognized the need for social and emotional support, and have enacted legislation such as the 1965 Older Americans Act, which assists state and area agencies on aging in providing in-house services, telephone checks, and group meals to foster social interactions among older adults. Similarly, programs such as Sisters in Support Together Against Substances which is designed to raise awareness of factors that can lead African American women to use and/or abuse drugs and alcohol, and Big Brothers Big Sisters, composed of volunteer adult mentors for children who often have troubled family lives, have also been shown to be effective. 

Despite the importance of social support to psychiatry and medicine, Strine et al is the only available research that investigates the correlation of the level of social and emotional support at the state or national levels on health-related outcomes. However, this study does not cover the long-term impact of social and emotional support. Other than Strine et al research that is probably mostly relevant to this study, there is no national studies examining the associations between social and emotional support, health-related quality of life (HRQOL), life satisfaction, and health behaviors; particularly after adjusting for sociodemographic characteristics. In addition, the impact of perceived social and emotional support among adults who suffer depression in a large sample of adults has not been studied yet. State estimates provide a framework for policymakers, and public health officials to identify local health requirements and assist in planning, directing, implementing, and monitoring the effectiveness of intervention and prevention strategies. National estimates provide a means for examining at risk populations for social and emotional isolation that may otherwise be overlooked. To examine these relationships, this paper used data from the Behavioral Risk Factor Surveillance System (BRFSS), a large representative sample of U.S. adults residing in the community from 2013 to 2017.


# Mechanisms and Previous Literature 
### Literature on the economics of social and emotional support

to be continued...

### Literature on the impact of social and emotional support on various health factors 

to be continued...

# Data and Empirical Framework

$$(Model - 1): BehavioralOutcomes{i,s,t}=\beta_0 + \beta_1SocialEmotionalSupport_{i,s,t} + \beta_XX_{i,s,t}+\tau_t+\gamma_s+\epsilon_{i,s,t}$$

$$(Model - 2): GeneralHealth_{i,s,t}=\beta_0 + \beta_1SocialEmotionalSupport_{i,s,t} + \beta_XX_{i,s,t}+\tau_t+\gamma_s+\epsilon_{i,s,t}$$

# Count Outcome Results


\captionsetup[justification=centering]{labelformat=empty,skip=1pt} 
{\footnotesize \begin{longtable}[c]{llll} 
\caption*{ Regression Results for Count Outcomes\\ 
\small \textit{Dependent variable: Count Outcomes} \\ 
} \\ 
\toprule \centering
 & Physical Unhealthy Days & Mental Unhealthy Days & Alcolhol Consumption \\  [-1.8ex] 
\\ & \textit{Zero-Inflated NB} & \textit{Zero-Inflated NB} & \textit{Zero-Inflated NB} \\ 
\\[-1.8ex] & (1) & (2) & (3)\\ 
\hline 
\midrule 
 emotional\_support & $-$0.103$^{***}$ & $-$0.268$^{***}$ & $-$0.011$^{*}$ \\ 
  & (0.003) & (0.002) & (0.006) \\ 
 health\_insured & $-$0.168$^{***}$ & $-$0.090$^{***}$ & $-$0.282$^{***}$ \\ 
  & (0.005) & (0.004) & (0.009) \\ 

 heart\_disease & 0.093$^{***}$ & 0.077$^{***}$ & $-$0.029$^{**}$ \\ 
  & (0.005) & (0.005) & (0.013) \\ 

 arthritis & 0.261$^{***}$ & 0.093$^{***}$ & $-$0.039$^{***}$ \\ 
  & (0.003) & (0.003) & (0.006) \\ 

 stroke & 0.135$^{***}$ & 0.073$^{***}$ & $-$0.074$^{***}$ \\ 
  & (0.005) & (0.005) & (0.014) \\ 

 asthma & 0.113$^{***}$ & 0.004 & $-$0.087$^{***}$ \\ 
  & (0.003) & (0.003) & (0.006) \\ 

 bronchitis & 0.166$^{***}$ & 0.100$^{***}$ & 0.110$^{***}$ \\ 
  & (0.004) & (0.004) & (0.009) \\ 

 diabete & 0.099$^{***}$ & 0.056$^{***}$ & $-$0.398$^{***}$ \\ 
  & (0.004) & (0.003) & (0.008) \\ 

 Constant & 1.605$^{***}$ & 2.354$^{***}$ & 1.923$^{***}$ \\ 
  & (0.014) & (0.011) & (0.024) \\ 
\hline \\[-1.8ex] 
Month FE & Yes & Yes & Yes \\ 
Year FE & Yes & Yes & Yes \\ 
State FE & Yes & Yes & Yes \\ 
Demographics & Yes & Yes & Yes \\
\hline \\[-1.8ex] 
Observations & 13,411 & 13,411 & 13,411 \\ 
\hline 
\hline \\[-1.8ex] 
\multicolumn{4}{l}{Note: Panel consists of the 2013-2017 survey sample waves of BRFSS. BRFSS weights applied. All}\\
\multicolumn{4}{l}{models control for demographics, including age, gender, race, income, education status, marital}\\
\multicolumn{4}{l}{status, employment status, number of children. See Appendix for detailed variable definition, and}\\
\multicolumn{4}{l}{construction.}\\
\multicolumn{4}{l}{ $^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
\bottomrule
\end{longtable}}

# Binary Outcome Results


\captionsetup[justification=centering]{labelformat=empty,skip=1pt} 
{\footnotesize \begin{longtable}[c]{llll} 
\caption*{ Regression Results for Binary Outcomes\\ 
\small \textit{Dependent variable: Binary Outcomes} \\ 
} \\ 
\toprule \centering
 &  Current Smoker & Overweight & Exercise\\ [-1.8ex] 
\\ & \textit{logistics} & \textit{logistics}  & \textit{logistics} \\ 
\\[-1.8ex] & (1) & (2) & (3)\\ 
\hline 
\midrule 
 emotional\_support & $-$0.229$^{***}$ & $-$0.077 & 0.115$^{**}$ \\ 
  & (0.062) & (0.056) & (0.052) \\ 
 health\_insured & $-$0.324$^{***}$ & $-$0.310$^{***}$ & 0.128 \\ 
  & (0.098) & (0.088) & (0.083) \\ 
 heart\_disease & $-$0.023 & $-$0.031 & $-$0.143 \\ 
  & (0.115) & (0.109) & (0.098) \\ 
 arthritis & 0.110$^{*}$ & $-$0.353$^{***}$ & $-$0.190$^{***}$ \\ 
  & (0.066) & (0.057) & (0.054) \\ 
 stroke & 0.446$^{***}$ & 0.405$^{***}$ & $-$0.295$^{***}$ \\ 
  & (0.129) & (0.110) & (0.100) \\ 
 asthma & $-$0.134$^{*}$ & $-$0.018 & $-$0.250$^{***}$ \\ 
  & (0.073) & (0.065) & (0.061) \\ 
 bronchitis & 1.031$^{***}$ & 0.113 & $-$0.349$^{***}$ \\ 
  & (0.090) & (0.082) & (0.076) \\ 
 diabete & $-$0.665$^{***}$ & $-$1.206$^{***}$ & $-$0.301$^{***}$ \\ 
  & (0.084) & (0.084) & (0.066) \\ 
 Constant & $-$1.366$^{***}$ & 1.674$^{***}$ & 0.304 \\ 
  & (0.268) & (0.235) & (0.227) \\ 
\hline \\[-1.8ex] 
Month FE & Yes & Yes & Yes \\ 
Year FE & Yes & Yes & Yes \\ 
State FE & Yes & Yes & Yes \\ 
Demographics & Yes & Yes & Yes \\
\hline \\[-1.8ex] 
Observations & 6,742 & 7,452 & 8,904 \\ 
\hline 
\hline \\[-1.8ex] 
\multicolumn{4}{l}{Note: Panel consists of the 2013-2017 survey sample waves of BRFSS.}\\
\multicolumn{4}{l}{BRFSS weights applied. Combination of upsampling \& downsampling sample}\\
\multicolumn{4}{l}{are applied in both models. All models control for demographics, including}\\
\multicolumn{4}{l}{age, gender,race, income, education status, marital status, employment-}\\
\multicolumn{4}{l}{status, number of children. See Appendix for detailed variable definition,}\\
\multicolumn{4}{l}{and construction.}\\
\multicolumn{4}{l}{ $^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
\bottomrule
\end{longtable}}











